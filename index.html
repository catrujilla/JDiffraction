<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>JDiffraction by unal-optodigital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?lang=java&skin=desert"></script>
    <link rel="shortcut icon" type="image/x-icon" href="images/icon.png">

    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-62159256-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <section class="page-header">
      <h1 class="project-name">JDiffraction</h1>
      <h2 class="project-tagline">Numerical wave propagation library for Java.</h2>
      <a href="https://github.com/unal-optodigital/JDiffraction" class="btn">View on GitHub</a>
      <a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.2.jar" class="btn">Download .jar</a>
      <a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.2-doc.zip" class="btn">Download javadocs</a>
    </section>

    <section class="main-content">
      <p>
        JDiffraction is a numerical wave propagation library for Java. Includes angular spectrum, Fresnel-Fourier and <a href="http://dx.doi.org/10.1364/AO.49.006430" target="_blank">Fresnel-Bluestein</a> methods. Aditionally it includes an utilities class, designed to work with the complex arrays required by the library.
      </p>

      <p>
        The library supports calculation on CPU and GPU, the latter is done using <a href="http://www.jcuda.org/" target="_blank">JCuda</a>. To use the GPGPU versions of the library <a href="http://www.jcuda.org/" target="_blank">JCuda</a> 0.7.5 jars must be in the java path, CUDA 7.5 and a CUDA capable GPU must be installed on the PC.
      </p>

      <p>
        If you are using JDiffraction and find a bug, please <a href="#contact">contact us</a>.
      </p>

      <hr>

      <h3>
        <a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples
      </h3>

      <p>
        An example of usage of JDiffraction on a simple <a href="http://imagej.nih.gov/ij/index.html" target="_blank">ImageJ</a>'s plugin. Diffraction of a circular aperture using the angular spectrum method. The parameters are meant to produce an even number of Fresnel zones on the diffraction pattern. The example can be downloaded as a <code>.java</code> file <a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction_Example.java">here</a>.
      </p>

      <p align="center">
        <img src="images/example-01.png" style="width:800px">
      </p>

      <p align="center">
        (a) Circular aperture. (b) GenericDialog for parameters. (c) Modulus of the propagated field.
      </p>

      <h4>
        Code:
      </h4>

      <pre class="prettyprint">
import ij.*;
import ij.gui.GenericDialog;
import ij.process.*;
import ij.plugin.filter.*;
import unal.od.jdiffraction.cpu.FloatAngularSpectrum;
import unal.od.jdiffraction.cpu.utils.ArrayUtils;

public class JDiffraction_Example implements PlugInFilter {

    ImagePlus imp;

    @Override
    public int setup(String arg, ImagePlus imp) {
        this.imp = imp;
        return DOES_ALL;
    }

    @Override
    public void run(ImageProcessor ip) {
        //gets the image data and creates the complex array
        int M = ip.getWidth();
        int N = ip.getHeight();

        float[][] image = ip.getFloatArray();
        float[][] field = ArrayUtils.complexAmplitude2(image, null);

        //unlocks the image because it's no longer needed
        imp.unlock();

        //Creates a GenericDialog object to ask the user for propagation
        //parameters
        GenericDialog gd = new GenericDialog("Parameters");
        gd.addNumericField("Wavelength", 633E-9, 10, 10, "m");
        gd.addNumericField("Distance", 1, 2, 10, "m");
        gd.addNumericField("Input width", 5E-3, 4, 10, "m");
        gd.addNumericField("Input height", 5E-3, 4, 10, "m");
        gd.showDialog();

        if (gd.wasCanceled()){
            return;
        }

        float wavelength = (float) gd.getNextNumber();
        float distance = (float) gd.getNextNumber();
        float inputWidth = (float) gd.getNextNumber();
        float inputHeight = (float) gd.getNextNumber();

        //Creates the AngularSpectrum object and diffracts the input field
        FloatAngularSpectrum as = new FloatAngularSpectrum(M, N, wavelength,
                distance, inputWidth / M, inputHeight / N);
        as.diffract(field);

        //Calculates the modulus of the output field and shows it
        float[][] modulus = ArrayUtils.modulus(field);

        ImageProcessor ipModulus = new FloatProcessor(modulus);
        ImagePlus impModulus = new ImagePlus("modulus", ipModulus);
        impModulus.show();
    }
}
      </pre>

      <hr>

      <h3>
        <a id="benchmark" class="anchor" href="#benchmark" aria-hidden="true"><span class="octicon octicon-link"></span></a>Benchmark
      </h3>

      <p>
        The library was benchmarked in its single precision versions, using a desktop PC with Intel Core i7 2600 (3.40 GHz), 8 GB of RAM memory and a NVIDIA GeForce GTX 580. The average times of execution are given in ms.
      </p>

      <h4>
        CPU times with and without constructor
      </h4>

      <table align="center">
        <tbody>
          <tr>
            <th rowspan="2">Image Size (Pixels)</th>
            <th colspan="2">Angular spectrum</th>
            <th colspan="2">Fresnel - Fourier</th>
            <th colspan="2">Fresnel - Bluestein</th>
          </tr>
		  
		  <tr>
            <td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
			<td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
			<td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
          </tr>
		  
          <tr>
            <td><b>512 x 512</b></td>
            <td>53.2</td>
			<td>5.4</td>
            <td>67.9</td>
			<td>4.1</td>
            <td>88.5</td>
			<td>7</td>
          </tr>

          <tr>
            <td><b>1024 x 1024</b></td>
            <td>215.6</td>
			<td>24.8</td>
            <td>270.3</td>
			<td>16.2</td>
            <td>357.8</td>
			<td>30.4</td>
          </tr>

          <tr>
            <td><b>2048 x 2048</b></td>
            <td>874.9</td>
			<td>111.6</td>
            <td>1115.8</td>
			<td>71.7</td>
            <td>1486.3</td>
			<td>135.7</td>
          </tr>
        </tbody>
      </table>

      <h4>
        GPU times with and without constructor
      </h4>

      <table align="center">
        <tbody>
          <tr>
            <th rowspan="2">Image Size (Pixels)</th>
            <th colspan="2">Angular spectrum</th>
            <th colspan="2">Fresnel - Fourier</th>
            <th colspan="2">Fresnel - Bluestein</th>
          </tr>
		  
		  <tr>
            <td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
			<td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
			<td><b>w/ const.</b></td>
			<td><b>w/o const.</b></td>
          </tr>
		  
          <tr>
            <td><b>512 x 512</b></td>
            <td>3.4</td>
			<td>2.5</td>
            <td>3</td>
			<td>2.1</td>
            <td>4.2</td>
			<td>3.4</td>
          </tr>

          <tr>
            <td><b>1024 x 1024</b></td>
            <td>5.9</td>
			<td>4.8</td>
			<td>4.8</td>
			<td>4.1</td>
			<td>8.1</td>
			<td>7.2</td>
          </tr>

          <tr>
            <td><b>2048 x 2048</b></td>
            <td>15.5</td>
			<td>15</td>
			<td>14.1</td>
			<td>13.5</td>
			<td>22.4</td>
			<td>21.9</td>
          </tr>
        </tbody>
      </table>

      <hr>

      <h3>
        <a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API
      </h3>

      <p>
        JDiffraction API can be found <a href="javadoc/index.html">here</a>.
      </p>

      <hr>

      <h3>
        <a id="downloads" class="anchor" href="#downloads" aria-hidden="true"><span class="octicon octicon-link"></span></a>Downloads
      </h3>

      <h4>
        Current release
      </h4>

      <ul>
        <li><a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.2.jar">JDiffraction-1.2.jar</a></li>
        <li><a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.2-doc.zip">JDiffraction-1.2-doc.zip</a></li>
      </ul>

      <h4>
        Older releases
      </h4>

      <ul>
        <li><a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.1.jar">JDiffraction-1.1.jar</a></li>
        <li><a href="http://ciencias.medellin.unal.edu.co/gruposdeinvestigacion/opticayprocesamientooptodigital/downloads/jdiffraction/JDiffraction-1.1-doc.zip">JDiffraction-1.1-doc.zip</a></li>
      </ul>

      <hr>
      <h3>
        <a id="credits" class="anchor" href="#credits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credits
      </h3>

      <p>
        JDiffraction uses <a href="https://sites.google.com/site/piotrwendykier/software/jtransforms" target="_blank">JTransforms</a> FFT routines and <a href="http://www.jcuda.org/" target="_blank">JCuda</a> Java bindings for NVIDIA CUDA.
      </p>

			<hr>
      <h3>
        <a id="citation" class="anchor" href="#citation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Citation
      </h3>

      <p>
        You can reference JDiffraction using:
      </p>

      <ol>
        <li>P. Piedrahita-Quintero, C. Trujillo, and J. Garcia-Sucerquia, "JDiffraction: A GPGPU-accelerated JAVA library for numerical propagation of scalar wave fields," Comput. Phys. Commun. 214, (2017). doi: <a href="https://doi.org/10.1016/j.cpc.2016.12.016" target="_blank">10.1016/j.cpc.2016.12.016</a></li>
      </ol>
			
      <hr>
      <h3>
        <a id="contact" class="anchor" href="#contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contact
      </h3>

      <ul>
        <li>Pablo Piedrahita-Quintero (<a href="mailto:jppiedrahitaq@unal.edu.co">jppiedrahitaq@unal.edu.co</a>)</li>
        <li>Carlos Trujillo (<a href="mailto:catrujila@unal.edu.co">catrujila@unal.edu.co</a>)</li>
        <li>Jorge Garcia-Sucerquia (<a href="mailto:jigarcia@unal.edu.co">jigarcia@unal.edu.co</a>)</li>
      </ul>

      <footer class="site-footer">
        <p align="center">
          <img src="images/un.png" style="height:70px" hspace="40">
          <img src="images/group-logo.png" style="height:70px" hspace="40">
        </p>

        <span class="site-footer-owner">
          <a href="https://github.com/unal-optodigital/JDiffraction">JDiffraction</a> is maintained by <a href="https://github.com/unal-optodigital">unal-optodigital</a>.
        </span>

        <span class="site-footer-credits">
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </span>
      </footer>

    </section>
  </body>
</html>
